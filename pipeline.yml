apiVersion: argoproj.io/v1alpha1
kind: WorkflowTemplate
metadata:
  name: ci-pipeline
spec:
  entrypoint: pipeline
  serviceAccountName: user-workflow-sa
  arguments:
    parameters:
      - name: payload
        value: empty
  templates:
  - name: pipeline
    steps:
    - - name: clone
        template: clone
        arguments:
          parameters:
          - name: payload
            value: "{{workflow.parameters.payload}}"

  - name: clone
    inputs:
      parameters:
      - name: payload
    container:
      image: alpine/git
      command: [echo]
      args: ["Payload received: {{inputs.parameters.payload}}"]
